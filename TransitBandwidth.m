function C = TransitBandwidth(P_Total,Vdc_PD,PD_width,Temperature)
Vac_M = Vdc_PD;
wi_M = PD_width;
dtemp_M = Temperature-25;
Power_M = P_Total;
Pq = 1.60217663e-19;
np = 1.0e24;
nn = 1.0e24;
ni = 1.2e20;
vbi = 0.320;
temperature = 298.15;
ege = 2*8.854187817e-12*16.0/Pq;
Vac = Vac_M;
vjun = -Vac + vbi;
wi = wi_M;
if (vjun >= 0)
    xp = (-2.0*np*wi + sqrt(4*np*np*wi*wi - 4.0*np*(ni*wi*wi-vjun*ege))) / (2*np);
    xi = 0.0;
    if (xp < 0)
        xp = 0.0;
        xi = wi - sqrt(ege*vjun/ni);
    end
    xn = (ni*(wi-xi) + np*xp) / nn;
    actw = xp + (wi-xi) + xn;
else
    actw = 0.0;
end
actw_M = actw;
detbw=1;
mobility = 0.24;
satvel = 5.72e5;
fac = 2.0;
Vac = Vac_M;
actw = actw_M;
Power = Power_M;
x = 10*log10(Power*1e3);
y = Vac;
wi = wi_M;
z = wi*1e9;
dtemp = dtemp_M;
dT = dtemp_M;
vjun = -Vac + vbi;
deltemp = temperature + dtemp - 298.15;
mobilityt = mobility*(1 - 0.0029*deltemp);
vstep = vjun;
wstep = actw;
if (vstep > 0.0)
    efield = (vstep+1e-6)/(wstep + 1e-15);
    linvd = mobilityt*detbw*efield;
    term = exp(fac*log(linvd/(satvel)));
    denom = exp((1/fac)*log(1.0 + term));

    vdrift = linvd/denom;

    trantime = (0.9*wstep/exp(-0.01e6*wstep))/(vdrift + 1);

else
    trantime=1e-15;
end

cap = trantime;
BW_ghz = (1/(2*pi*1*2*cap))*1e-9;
p00 = -1.247202058628618e-04*z+0.766445606081940;
p10 = -1.36040182331462e-05*z-0.0554715434274358;
p01 = 4.35969068249696e-05*z-0.287588328625865;
p20 = 1.50629406367804e-06*z-0.00707239698390366;
p11 = 2.50716519998148e-05*z-0.0656257683862521;
p02 = 3.01690068854493e-05*z-0.0826342806323659;
p30 = 3.10866713606994e-07*z-0.000529824577339067;
p21 = 3.97597815642609e-06*z-0.00629157910939061;
p12 = 1.10345250758435e-05*z-0.0184494108363992;
p40 = 1.17050091129382e-08*z-1.76831423081108e-05;
p31 = 2.86327509349808e-07*z-0.000311386955253029;
p22 = 9.71231665186350e-07*z-0.00133661075388362;
p50 = 3.89800167649276e-11*z-1.63208701015761e-07;
p41 = 7.53850334033513e-09*z-6.48537514236075e-06;
p32 = 2.15971728325192e-08*z-2.88023618330523e-05;

CF = p00+p10.*x+p01.*y+p20.*x.^2+p11.*x.*y+p02.*y.^2+p30.*x.^3+p21.*x.^2.*y+p12.*x.*y.^2+p40.*x.^4+p31.*x.^3.*y+p22.*x.^2*y.^2+p50.*x.^5+p41*x.^4.*y+p32.*x.^3.*y.^2;

a1 = 6.73325675911417e-11*z-4.64523018659763e-08;
a2 = -9.33415008818772e-09*z+6.49097077461937e-06;
a3 = 5.77717036677102e-07*z-0.000432647170088626;
a4 = -5.50128175646171e-05*z+0.0448170869045598;
a5 = -0.000217455636669391*z+0.184473015119408;

b1 = 9.17140951401710e-12*z-7.90975493717506e-09;
b2 = -1.37400316257247e-09*z+1.12847459766989e-06;
b3 = 6.59376348599212e-08*z-4.89692643334825e-05;
b4 = -2.52982406360423e-06*z+0.00194774427261544;
b5 = -1.36241141523482e-05*z+0.0112430431326115;

c1 = 2.40556352277852e-10*z-1.55641028739367e-07;
c2 = -3.21904928080238e-08*z+2.13189274705080e-05;
c3 = 1.12953809769657e-06*z-0.000826376587851961;
c4 = -1.83760959891996e-06*z-0.00397387880873462;
c5 = -0.000176670045704267*z+0.173521756952295;

d1 = 1.74939255982213e-11*z-1.23190190603203e-08;
d2 = -2.44868393175005e-09*z+1.80525160311899e-06;
d3 = 1.04570147449798e-07*z-8.19112877441791e-05;
d4 = 2.63032794745322e-06*z-0.00329736759905818;
d5 = -1.10457494965530e-05*z+0.0142537843415873;

e1 = -1.04095371871105e-12*z+7.36123800699129e-10;
e2 = 1.23095354859071e-10*z-8.34272136762070e-08;
e3 = -6.41045731190413e-10*z+1.76203740235331e-07;
e4 = -4.87566325388834e-09*z-5.63682477233061e-05;
e5 = -3.24836429902241e-07*z+0.000426237856830897;

a = a1*dT^4+a2*dT^3+a3*dT^2+a4*dT+a5;
b = b1*dT^4+b2*dT^3+b3*dT^2+b4*dT+b5;
c = c1*dT^4+c2*dT^3+c3*dT^2+c4*dT+c5;
d = d1*dT^4+d2*dT^3+d3*dT^2+d4*dT+d5;
e = e1*dT^4+e2*dT^3+e3*dT^2+e4*dT+e5;

RF = a+b*x+c*y+d*x*y+e*x.^2*y;

BW_ghz_M = CF*BW_ghz-RF;

C = (1./(2*pi*1*2*BW_ghz_M))*1e-9;
end
